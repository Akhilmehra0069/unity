<apex:page standardController="Community_Events__c" extensions="CommunityEventController" action="{!initFromEdit}" showHeader="false" sideBar="false" docType="html-5.0" applyBodyTag="false" applyHtmlTag="false">
	
<script src="{!$Resource.CommunityResources}/js/underscore/underscore-min.js"></script>
<script type="text/javascript" src="{!$Resource.assets}/plugins/sky-forms/version-2.0.1/js/jquery-ui.min.js"></script>

<apex:composition template="{!$Site.Template}">
<apex:define name="title">{!$Label.LBL_Page_Title}</apex:define>
<apex:define name="body">
	<apex:form >
		<div class="container">
			<div class="row margin-bottom-10">
				<div class="col-md-6 text-left padding-left-35">
					<h2>{!Title}</h2>
				</div>
				<div class="col-md-6 text-right padding-right-25">
					<apex:commandButton action="{!Submit}" value="{!$Label.BTN_Submit}" styleClass="btn-u"/>
					&nbsp;
					<apex:outputLink value="{!IF(ISBLANK($CurrentPage.parameters.retURL),$Page.CommunityEventsList,JSENCODE($CurrentPage.parameters.retURL))}" styleClass="btn-u">{!$Label.BTN_Cancel}</apex:outputLink>
					</div>	
			</div>
		</div>
		<apex:pageBlock >
		    <apex:pageMessages id="pageMessages"/>			
			<apex:pageBlockSection id="cnpbs1" columns="1" collapsible="false">
				<apex:repeat value="{!fieldset}" var="fs">
					<apex:inputField value="{!event[fs.fieldPath]}" required="{!OR(fs.required, fs.dbrequired)}"/>
				</apex:repeat>
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.LBL_Event_Group}"/>
					<apex:input value="{!connectedGroupStr}" list="{!AllGroupsInStringArray}" />			
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="{!$Label.LBL_Select_Tags}"/>
					<c:CommunityTagSelector oId="{!event.Id}" oType="{!$ObjectType.Community_Event_Tag__c.Name}" fName="{!$ObjectType.Community_Event_Tag__c.Fields.Community_Event__c.Name}"/>
				</apex:pageBlockSectionItem>
			</apex:pageBlockSection>
		</apex:pageBlock>
	</apex:form>
</apex:define>
</apex:composition>

<script type="text/javascript" src="{!$Resource.assets}/plugins/datetimepicker/jquery.datetimepicker.js"></script>
<apex:stylesheet value="{!$Resource.assets}/plugins/datetimepicker/jquery.datetimepicker.css" />

<script>
	var dateElements = $(".dateInput input");
	
	_.each(dateElements, function(e){
		e.className = "validate-datetimepicker";
		e.removeAttribute("onfocus");
		
	});

	if($('.validate-datetimepicker')) {
		var currentdate = new Date(); 
		var datetime = (currentdate.getMonth()+1) + '/' + currentdate.getDate() + '/' + currentdate.getFullYear() + ' ' + currentdate.getHours() + ":"  + currentdate.getMinutes();
		$('.validate-datetimepicker').datetimepicker({
			minDate:datetime,
			format:'m/d/Y h:i A',
			formatTime:'h:i A',
			formatDate:'m/d/Y',
			step:30
		});
	}
	
</script>


</apex:page>